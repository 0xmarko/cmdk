"use client";import{a as le}from"./chunk-NZJY6EH4.mjs";import*as k from"@radix-ui/react-dialog";import*as t from"react";import{Primitive as M}from"@radix-ui/react-primitive";import{useId as O}from"@radix-ui/react-id";import{composeRefs as j}from"@radix-ui/react-compose-refs";var B='[cmdk-group=""]',ee='[cmdk-group-items=""]',ye='[cmdk-group-heading=""]',de='[cmdk-item=""]',ue=`${de}:not([aria-disabled="true"])`,te="cmdk-item-select",H="data-value",Ee=(r,o,n)=>le(r,o,n),fe=t.createContext(void 0),$=()=>t.useContext(fe),me=t.createContext(void 0),ne=()=>t.useContext(me),pe=t.createContext(void 0),ve=t.forwardRef((r,o)=>{let n=A(()=>{var e,s;return{search:"",value:(s=(e=r.value)!=null?e:r.defaultValue)!=null?s:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),u=A(()=>new Set),c=A(()=>new Map),d=A(()=>new Map),f=A(()=>new Set),p=ge(r),{label:g,children:m,value:R,onValueChange:x,filter:S,shouldFilter:C,loop:_,disablePointerSelection:be=!1,vimBindings:z=!0,async:F=!1,fetchInProgress:W=!1,...T}=r,V=O(),q=O(),h=O(),I=t.useRef(null),he=t.useRef(null),P=Le();t.useImperativeHandle(o,()=>({selectFirstItem:N}),[]),w(()=>{if(R!==void 0){let e=R.trim();n.current.value=e,E.emit()}},[R]),w(()=>{F&&!W&&P(1,N)},[F,W]),w(()=>{P(6,oe)},[]);let E=t.useMemo(()=>({subscribe:e=>(f.current.add(e),()=>f.current.delete(e)),snapshot:()=>n.current,setState:(e,s,a)=>{var i,l,v,y;if(!Object.is(n.current[e],s)){if(n.current[e]=s,e==="search")Q(),X(),F||P(1,N);else if(e==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let b=document.getElementById(h);b?b.focus():(i=document.getElementById(V))==null||i.focus()}if(P(7,()=>{var b;n.current.selectedItemId=(b=L())==null?void 0:b.id,E.emit()}),a||P(5,oe),((l=p.current)==null?void 0:l.value)!==void 0){let b=s!=null?s:"";(y=(v=p.current).onValueChange)==null||y.call(v,b);return}}E.emit()}},emit:()=>{f.current.forEach(e=>e())}}),[F]),J=t.useMemo(()=>({value:(e,s,a)=>{var i;s!==((i=d.current.get(e))==null?void 0:i.value)&&(d.current.set(e,{value:s,keywords:a}),n.current.filtered.items.set(e,re(s,a)),P(2,()=>{X(),E.emit()}))},item:(e,s)=>(u.current.add(e),s&&(c.current.has(s)?c.current.get(s).add(e):c.current.set(s,new Set([e]))),P(3,()=>{Q(),X(),n.current.value||N(),E.emit()}),()=>{d.current.delete(e),u.current.delete(e),n.current.filtered.items.delete(e);let a=L();P(4,()=>{Q(),(a==null?void 0:a.getAttribute("id"))===e&&N(),E.emit()})}),group:e=>(c.current.has(e)||c.current.set(e,new Set),()=>{d.current.delete(e),c.current.delete(e)}),filter:()=>p.current.shouldFilter,label:g||r["aria-label"],getDisablePointerSelection:()=>p.current.disablePointerSelection,listId:V,inputId:h,labelId:q,listInnerRef:I}),[]);function re(e,s){var i,l;let a=(l=(i=p.current)==null?void 0:i.filter)!=null?l:Ee;return e?a(e,n.current.search,s):0}function X(){if(!n.current.search||p.current.shouldFilter===!1)return;let e=n.current.filtered.items,s=[];n.current.filtered.groups.forEach(i=>{let l=c.current.get(i),v=0;l.forEach(y=>{let b=e.get(y);v=Math.max(b,v)}),s.push([i,v])});let a=I.current;G().sort((i,l)=>{var b,K;let v=i.getAttribute("id"),y=l.getAttribute("id");return((b=e.get(y))!=null?b:0)-((K=e.get(v))!=null?K:0)}).forEach(i=>{let l=i.closest(ee);l?l.appendChild(i.parentElement===l?i:i.closest(`${ee} > *`)):a.appendChild(i.parentElement===a?i:i.closest(`${ee} > *`))}),s.sort((i,l)=>l[1]-i[1]).forEach(i=>{var v;let l=(v=I.current)==null?void 0:v.querySelector(`${B}[${H}="${encodeURIComponent(i[0])}"]`);l==null||l.parentElement.appendChild(l)})}function N(){let e=G().find(a=>a.getAttribute("aria-disabled")!=="true"),s=e==null?void 0:e.getAttribute(H);E.setState("value",s||void 0)}function Q(){var s,a,i,l;if(!n.current.search||p.current.shouldFilter===!1){n.current.filtered.count=u.current.size;return}n.current.filtered.groups=new Set;let e=0;for(let v of u.current){let y=(a=(s=d.current.get(v))==null?void 0:s.value)!=null?a:"",b=(l=(i=d.current.get(v))==null?void 0:i.keywords)!=null?l:[],K=re(y,b);n.current.filtered.items.set(v,K),K>0&&e++}for(let[v,y]of c.current)for(let b of y)if(n.current.filtered.items.get(b)>0){n.current.filtered.groups.add(v);break}n.current.filtered.count=e}function oe(){var s,a,i;let e=L();e&&(((s=e.parentElement)==null?void 0:s.firstChild)===e&&((i=(a=e.closest(B))==null?void 0:a.querySelector(ye))==null||i.scrollIntoView({block:"nearest"})),e.scrollIntoView({block:"nearest"}))}function L(){var e;return(e=I.current)==null?void 0:e.querySelector(`${de}[aria-selected="true"]`)}function G(){var e;return Array.from(((e=I.current)==null?void 0:e.querySelectorAll(ue))||[])}function Y(e){let a=G()[e];a&&E.setState("value",a.getAttribute(H))}function Z(e){var v;let s=L(),a=G(),i=a.findIndex(y=>y===s),l=a[i+e];(v=p.current)!=null&&v.loop&&(l=i+e<0?a[a.length-1]:i+e===a.length?a[0]:a[i+e]),l&&E.setState("value",l.getAttribute(H))}function ie(e){let s=L(),a=s==null?void 0:s.closest(B),i;for(;a&&!i;)a=e>0?Me(a,B):Te(a,B),i=a==null?void 0:a.querySelector(ue);i?E.setState("value",i.getAttribute(H)):Z(e)}let ae=()=>Y(G().length-1),se=e=>{e.preventDefault(),e.metaKey?ae():e.altKey?ie(1):Z(1)},ce=e=>{e.preventDefault(),e.metaKey?Y(0):e.altKey?ie(-1):Z(-1)};return t.createElement(M.div,{ref:he,tabIndex:-1,...T,"cmdk-root":"",onKeyDown:e=>{var a;(a=T.onKeyDown)==null||a.call(T,e);let s=e.nativeEvent.isComposing||e.keyCode===229;if(!(e.defaultPrevented||s))switch(e.key){case"n":case"j":{z&&e.ctrlKey&&se(e);break}case"ArrowDown":{se(e);break}case"p":case"k":{z&&e.ctrlKey&&ce(e);break}case"ArrowUp":{ce(e);break}case"Home":{e.preventDefault(),Y(0);break}case"End":{e.preventDefault(),ae();break}case"Enter":{e.preventDefault();let i=L();if(i){let l=new Event(te);i.dispatchEvent(l)}}}}},t.createElement("label",{"cmdk-label":"",htmlFor:J.inputId,id:J.labelId,style:Ae},g),U(r,e=>t.createElement(me.Provider,{value:E},t.createElement(fe.Provider,{value:J},e))))}),Ce=t.forwardRef((r,o)=>{var V,q;let n=O(),u=t.useRef(null),c=t.useContext(pe),d=$(),f=ge(r),p=(q=(V=f.current)==null?void 0:V.forceMount)!=null?q:c==null?void 0:c.forceMount;w(()=>{if(!p)return d.item(n,c==null?void 0:c.id)},[p]);let g=Re(n,u,[r.value,r.children,u],r.keywords),m=ne(),R=D(h=>h.value&&h.value===g.current),x=D(h=>p||d.filter()===!1?!0:h.search?h.filtered.items.get(n)>0:!0);t.useEffect(()=>{let h=u.current;if(!(!h||r.disabled))return h.addEventListener(te,S),()=>h.removeEventListener(te,S)},[x,r.onSelect,r.disabled]);function S(){var h,I;C(),(I=(h=f.current).onSelect)==null||I.call(h,g.current)}function C(){m.setState("value",g.current,!0)}if(!x)return null;let{disabled:_,value:be,onSelect:z,forceMount:F,keywords:W,...T}=r;return t.createElement(M.div,{ref:j(u,o),...T,id:n,"cmdk-item":"",role:"option","aria-disabled":!!_,"aria-selected":!!R,"data-disabled":!!_,"data-selected":!!R,onPointerMove:_||d.getDisablePointerSelection()?void 0:C,onClick:_?void 0:S},r.children)}),Se=t.forwardRef((r,o)=>{let{heading:n,children:u,forceMount:c,...d}=r,f=O(),p=t.useRef(null),g=t.useRef(null),m=O(),R=$(),x=D(C=>c||R.filter()===!1?!0:C.search?C.filtered.groups.has(f):!0);w(()=>R.group(f),[]),Re(f,p,[r.value,r.heading,g]);let S=t.useMemo(()=>({id:f,forceMount:c}),[c]);return t.createElement(M.div,{ref:j(p,o),...d,"cmdk-group":"",role:"presentation",hidden:x?void 0:!0},n&&t.createElement("div",{ref:g,"cmdk-group-heading":"","aria-hidden":!0,id:m},n),U(r,C=>t.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":n?m:void 0},t.createElement(pe.Provider,{value:S},C))))}),xe=t.forwardRef((r,o)=>{let{alwaysRender:n,...u}=r,c=t.useRef(null),d=D(f=>!f.search);return!n&&!d?null:t.createElement(M.div,{ref:j(c,o),...u,"cmdk-separator":"",role:"separator"})}),Ie=t.forwardRef((r,o)=>{let{onValueChange:n,...u}=r,c=r.value!=null,d=ne(),f=D(m=>m.search),p=D(m=>m.selectedItemId),g=$();return t.useEffect(()=>{r.value!=null&&d.setState("search",r.value)},[r.value]),t.createElement(M.input,{ref:o,...u,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":g.listId,"aria-labelledby":g.labelId,"aria-activedescendant":p,id:g.inputId,type:"text",value:c?r.value:f,onChange:m=>{c||d.setState("search",m.target.value),n==null||n(m.target.value)}})}),Pe=t.forwardRef((r,o)=>{let{children:n,label:u="Suggestions",...c}=r,d=t.useRef(null),f=t.useRef(null),p=D(m=>m.selectedItemId),g=$();return t.useEffect(()=>{if(f.current&&d.current){let m=f.current,R=d.current,x,S=new ResizeObserver(()=>{x=requestAnimationFrame(()=>{let C=m.offsetHeight;R.style.setProperty("--cmdk-list-height",C.toFixed(1)+"px")})});return S.observe(m),()=>{cancelAnimationFrame(x),S.unobserve(m)}}},[]),t.createElement(M.div,{ref:j(d,o),...c,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":p,"aria-label":u,id:g.listId},U(r,m=>t.createElement("div",{ref:j(f,g.listInnerRef),"cmdk-list-sizer":""},m)))}),we=t.forwardRef((r,o)=>{let{open:n,onOpenChange:u,overlayClassName:c,contentClassName:d,container:f,...p}=r;return t.createElement(k.Root,{open:n,onOpenChange:u},t.createElement(k.Portal,{container:f},t.createElement(k.Overlay,{"cmdk-overlay":"",className:c}),t.createElement(k.Content,{"aria-label":r.label,"cmdk-dialog":"",className:d},t.createElement(ve,{ref:o,...p}))))}),De=t.forwardRef((r,o)=>D(u=>u.filtered.count===0)?t.createElement(M.div,{ref:o,...r,"cmdk-empty":"",role:"presentation"}):null),ke=t.forwardRef((r,o)=>{let{progress:n,children:u,label:c="Loading...",...d}=r;return t.createElement(M.div,{ref:o,...d,"cmdk-loading":"",role:"progressbar","aria-valuenow":n,"aria-valuemin":0,"aria-valuemax":100,"aria-label":c},U(r,f=>t.createElement("div",{"aria-hidden":!0},f)))}),Ne=Object.assign(ve,{List:Pe,Item:Ce,Input:Ie,Group:Se,Separator:xe,Dialog:we,Empty:De,Loading:ke});function Me(r,o){let n=r.nextElementSibling;for(;n;){if(n.matches(o))return n;n=n.nextElementSibling}}function Te(r,o){let n=r.previousElementSibling;for(;n;){if(n.matches(o))return n;n=n.previousElementSibling}}function ge(r){let o=t.useRef(r);return w(()=>{o.current=r}),o}var w=typeof window=="undefined"?t.useEffect:t.useLayoutEffect;function A(r){let o=t.useRef();return o.current===void 0&&(o.current=r()),o}function D(r){let o=ne(),n=()=>r(o.snapshot());return t.useSyncExternalStore(o.subscribe,n,n)}function Re(r,o,n,u=[]){let c=t.useRef(),d=$();return w(()=>{var g;let f=(()=>{var m;for(let R of n){if(typeof R=="string")return R.trim();if(typeof R=="object"&&"current"in R)return R.current?(m=R.current.textContent)==null?void 0:m.trim():c.current}})(),p=u.map(m=>m.trim());d.value(r,f,p),(g=o.current)==null||g.setAttribute(H,f),c.current=f}),c}var Le=()=>{let[r,o]=t.useState(),n=A(()=>new Map);return w(()=>{n.current.forEach(u=>u()),n.current=new Map},[r]),(u,c)=>{n.current.set(u,c),o({})}};function He(r){let o=r.type;return typeof o=="function"?o(r.props):"render"in o?o.render(r.props):r}function U({asChild:r,children:o},n){return r&&t.isValidElement(o)?t.cloneElement(He(o),{ref:o.ref},n(o.props.children)):n(o)}var Ae={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};export{Ne as Command,we as CommandDialog,De as CommandEmpty,Se as CommandGroup,Ie as CommandInput,Ce as CommandItem,Pe as CommandList,ke as CommandLoading,ve as CommandRoot,xe as CommandSeparator,Ee as defaultFilter,D as useCommandState};
